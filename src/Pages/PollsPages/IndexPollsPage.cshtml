@page
@using ContosoCrafts.WebSite.Models
@model ContosoCrafts.WebSite.Pages.PollsPages.IndexPollsPageModel
@{
    ViewData["Title"] = "Polls Page";
}

<div class="container">

    <div class="row">

        <div class="col-12">

            <h1>Submit Your Votes Now !!</h1>


            @{
                // Check if CookieNameValue is Null
                if (Model.CookieNameValue == null)
                {
                    // Disable Button
                        <p>@Model.Message</p>
                    <a href="#" class="btn btn-info disabled" role="button" aria-disabled="true">Create Poll</a>

                }
                else
                {
                    // User is Logged In
                    // Enable Button
                    <a class="btn btn-info" asp-page="/PollsPages/CreatePollPage" aria-disabled="false">Create Poll</a>
                }
            }

            <a asp-page="/PollsPages/GuidelinePage" class="btn btn-info">Guidelines</a>

            <hr />


            <div class="container">
                <div class="row">
                    @{
                        foreach (PollModel poll in Model.Polls)
                        {
                            <div class="col-4">
                                <div class="card text-white bg-dark mb-3">
                                    <div class="card-body">
                                        <h2 class="card-title"> @poll.Title</h2>
                                        <hr />
                                        <p class="card-subtitle">  @poll.Description </p>
                                        <div class="card-body">
                                            @foreach (OpinionItem item in poll.OpinionItems.ToList())
                                            {

                                                <div class="row">
                                                    <div class="col-auto">
                                                        <input class="form-check-input" type="radio" name="gridRadios" id="gridRadios2" value="option2">
                                                        <label>@item.OpinionName</label>
                                                    </div>
                                                    <div class="col-auto">
                                                        <label>Votes: @item.NumCounts</label>
                                                    </div>
                                                </div>

                                            }

                                        </div>

                                        @{
                                            var getAuthor = @Model.UserService.GetUser(poll.UserID);

                                            // Author No Longer Exists: Account Was Deleted
                                            if (getAuthor == null)
                                            {
                                                <label>Author No Longer Exists</label>
                                            }
                                            else
                                            {
                                                <label>Author Name: @getAuthor.Username</label>
                                                <label>Author Location: @getAuthor.Location</label>
                                            }
                                        }
                                        <hr />
                                        <a class="btn btn-outline-success">Submit Vote</a>
                                        <a class="btn btn-outline-primary">Edit Poll</a>
                                    </div>
                                </div>
                            </div>
                        }
                    }
                </div>
            </div>

        </div>

    </div>

</div>

